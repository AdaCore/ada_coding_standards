# Flag if No_Dispatch restriction is not used

import stdlib

@memoize
fun find_restriction(restriction) =
    (select first p@Pragma when p.f_id.p_name_is("Restrictions") and 
	                      p.f_args[1].p_assoc_expr() is 
						  e@Expr and e.p_name_is(restriction)) == null
	
@check(message="Restriction No_Dispatch not set")
fun no_classwide_constructs(node) =
    node is CompilationUnit
    when find_restriction("No_Dispatch")
